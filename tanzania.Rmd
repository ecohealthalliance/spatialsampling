---
title: "Spatial Sampling Scenarios for Tanzania"
author: "Ernest Guevarra"
date: "07/01/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  message = FALSE,
  warning = FALSE,
  error = FALSE,
  echo = TRUE
)

## Load libraries
if (!require(remotes)) install.packages("remotes")
remotes::install_github("spatialworks/tanzania")
remotes::install_github("spatialworks/spatialsampler")

library(rgdal)
library(rgeos)
library(raster)
library(tanzania)
library(spatialsampler)
```

## Context
A study to be conducted in the northeastern border of Tanzania from Arusha up to west to Serengeti that will collect human population samples/information, livestock samples/information and also land use/land disturbance information. The question is what possible sampling approaches can be used that can unify these different sources of data for the study.

```{r map1, echo = FALSE, fig.cap = "Northeastern border of Tanzania from Arusha to Serengeti", fig.align = "center"}
## Subset region to study area
studyArea <- region[region$Region_Nam %in% c("Arusha", "Mara"), ]

## Plot study area
par(mar = c(0,0,0,0))
plot(studyArea, lty = 0)
plot(region, lwd = 1, add = TRUE)
plot(studyArea, lwd = 2, col = "gray70", add = TRUE)

## Inset
par(plt = c(0.79, 0.99, 0.79, 0.99), new = TRUE)
plot(region, lwd = 0.5)
plot(studyArea, col = "gray50", add = TRUE)
polygon(x = c(bbox(studyArea)[1, 1] - 0.2, bbox(studyArea)[1, 1] - 0.2,
              bbox(studyArea)[1, 2] + 0.2, bbox(studyArea)[1, 2] + 0.2),
        y = c(bbox(studyArea)[2, 1] - 0.2, bbox(studyArea)[2, 2] + 0.2,
              bbox(studyArea)[2, 2] + 0.2, bbox(studyArea)[2, 1] - 0.2),
        border = "red", lwd = 1)
box(which = "plot", lty = "solid", lwd = 2)
```

Other factors/conditions to consider are:

1. Population density of humans decrease as population density of livestock increase and as population density of humans increase, population density of livestock decrease.

2. In order to study land disturbance properly, samples/information need to also be collected in areas where humand and livestock do not reside/stay.

Additional assumptions made:

1. Approach to study sampling is using cluster sampling (CS) rather than simple random sampling (SRS).

2. Study will use the data perform general estimation of specific indicators but mostly to use the data and the indicators for modelling to address study questions.

This document provides some ideas/insights as to how sampling for a study can be done in the given context and the stated parameters and assumptions.

## Data and tools used for sampling scenario building

To build the sampling scenarios, the following datasets were retrieved and utilised:

1. Region, district, ward and village enumeration area boundaries datasets for Tanzania - the region, district and ward boundaries dataset were retrieved from the Tanzania Bureau of Statistics (www.nbs.go.tz). The village enumeration area boundaries dataset was retrieved from the Tanzania Bureau of Statistics years back but is not found in the bureau's current website. This dataset includes population of each village enumeration area (based on 2002 census). These datasets were accessed via an R package called `tanzania` from the following Github repository (https://github.com/spatialworks/tanzania).

2. Boundaries map of livelihood zones of Tanzania - available from the Famine Early Warning Sytems Network or FEWS Net - https://fews.net/east-africa/tanzania/livelihood-zone-map/november-2009; This dataset is accessed via an R package called `tanzania` from the following Github repository (https://github.com/spatialworks/tanzania).

3. Raster map of ruminant livestock population - retrieved from the Gridded Livestock of the World (GLW) Database (https://dataverse.harvard.edu/dataverse/glw_3). This dataset is accessed via an R package called `tanzania` from the following Github repository (https://github.com/spatialworks/tanzania).

4. The package `spatialsampler` was used to perform grid-based sampling. The package is available via GitHub at https://github.com/spatialworks/spatialsampler

## Sampling scenarios

### Cluster sample selected proportional to population size

* This will be a more traditional approach to sampling.

* Limitation will be that the resulting sample will be representative of human population but may not be of the livestock population given that areas with high population density will most likely have lesser livestock population

```{r livestock, echo = FALSE, fig.cap = "Ruminant population in the study area", fig.align = "center"}
## Subset village to study areas
studyVillages <- village[village$REGNAME %in% c("Arusha", "Mara"), ]

## Plot study area
par(mar = c(0,0,0,0))
plot(studyArea, lty = 0)
plot(ruminant_population, add = TRUE)
plot(studyVillages, lwd = 1, border = "gray50", add = TRUE)
plot(region, lwd = 1, add = TRUE)
plot(studyArea, lwd = 3, add = TRUE)
```
### Spatial sampling

```{r basic_spatial, echo = TRUE, fig.align = "center"}
## Subset village to study areas
studyVillages <- village[village$REGNAME %in% c("Arusha", "Mara"), ]

par(mar = c(0,0,0,0))

## Plot base maps
plot(studyArea, lty = 0)
plot(studyVillages, border = "darkgreen", add = TRUE)
plot(studyArea, lwd = 2, add = TRUE)

## Create sampling grid (n = 30 square grids)
studySP <- create_sp_grid(x = studyArea, 
                          n = 30,
                          country = "Tanzania", 
                          buffer = 2, type = "csas")

## Get nearest point
studyVillagesSP <- data.frame(coordinates(studyVillages), studyVillages@data)
names(studyVillagesSP) <- c("x", "y", names(studyVillages@data))

studySampleVillages <- get_nearest_point(data = studyVillagesSP,
                                         data.x = "x", data.y = "y",
                                         query = studySP, n = 1)

plot(studySP, cex = 0.3, add = TRUE)
points(studySampleVillages[ , c("x", "y")], cex = 0.5, pch = 0, col = "blue")
```

```{r sample-table, echo = FALSE}
tab <- studySampleVillages[ , c("spid", "REGNAME", "DISTNAME", "WARD_NAME", "STREET", "TOTAL")]
names(tab) <- c("SPID", "Region", "District", "Ward", "Street", "Population")

knitr::kable(x = tab)
```


```{r livelihood_zones, echo = FALSE, eval = FALSE, fig.align = "center"}
## Subset village to study areas
studyVillages <- village[village$REGNAME %in% c("Arusha", "Mara"), ]

plot(studyArea, lty = 0)
plot(livelihood_zone, lwd = 2, border = "red", add = TRUE)
plot(region, lwd = 2, border = "blue", add = TRUE)
#plot(studyVillages, border = "darkgreen", add = TRUE)
```


